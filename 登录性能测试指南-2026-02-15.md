# ç™»å½•æ€§èƒ½æµ‹è¯•æŒ‡å—

**æµ‹è¯•æ—¥æœŸ**: 2026-02-15  
**æµ‹è¯•ç›®æ ‡**: éªŒè¯ç™»å½•æ€§èƒ½ä¼˜åŒ–æ•ˆæœ  

---

## ğŸ¯ æµ‹è¯•ç›®æ ‡

### æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | ç›®æ ‡ | ä¼˜åŒ–å‰ | ä¼˜åŒ–å |
|-----|------|-------|-------|
| æ€»è€—æ—¶ | < 300ms | 207-527ms | 107-227ms |
| å¯†ç éªŒè¯ | < 200ms | 200-500ms | 100-200ms |
| æ•°æ®åº“æŸ¥è¯¢ | < 20ms | 5-20ms | 5-20ms |
| JWT ç”Ÿæˆ | < 5ms | 1-5ms | 1-5ms |

### æ€§èƒ½ç­‰çº§

- âœ… **ä¼˜ç§€** (< 100ms)
- âœ… **è‰¯å¥½** (100-300ms) â† ç›®æ ‡
- âš ï¸ **ä¸€èˆ¬** (300-500ms)
- âŒ **è¾ƒå·®** (> 500ms)

---

## ğŸ§ª æµ‹è¯•æ–¹æ³•

### æ–¹æ³• 1: åç«¯æ—¥å¿—æµ‹è¯•

#### æ­¥éª¤ 1: å¯åŠ¨åç«¯
```bash
cd backend
python -m uvicorn app.main:app --reload
```

#### æ­¥éª¤ 2: æµ‹è¯•ç™»å½•
```bash
# åœ¨å¦ä¸€ä¸ªç»ˆç«¯æ‰§è¡Œ
curl -X POST http://localhost:8000/api/auth/login \
  -H "Content-Type: application/json" \
  -d '{"username":"director1","password":"password123"}'
```

#### æ­¥éª¤ 3: æŸ¥çœ‹æ—¥å¿—
```
åç«¯æ§åˆ¶å°åº”è¯¥è¾“å‡ºï¼š

LOGIN START: 2026-02-15 10:30:45
Step 1: Query user from database START
Step 1: Query user from database END - Duration: 8.50ms
Step 2: Password verification START
Step 2: Password verification END - Duration: 120.30ms
Step 3: Role validation START
Step 3: Role validation END - Duration: 0.10ms
Step 4: JWT token generation START
Step 4: JWT token generation END - Duration: 2.50ms
Step 5: Response preparation START
Step 5: Response preparation END - Duration: 0.20ms
LOGIN END: 2026-02-15 10:30:45
LOGIN DURATION BREAKDOWN:
  - DB Query: 8.50ms
  - Password Verify: 120.30ms
  - Role Validation: 0.10ms
  - JWT Generation: 2.50ms
  - Response Prep: 0.20ms
  - TOTAL: 131.60ms
```

#### æ­¥éª¤ 4: åˆ†æç»“æœ
- âœ… æ€»è€—æ—¶: 131.60ms (< 300ms)
- âœ… å¯†ç éªŒè¯: 120.30ms (< 200ms)
- âœ… æ•°æ®åº“æŸ¥è¯¢: 8.50ms (< 20ms)
- âœ… JWT ç”Ÿæˆ: 2.50ms (< 5ms)

---

### æ–¹æ³• 2: æµè§ˆå™¨å¼€å‘è€…å·¥å…·æµ‹è¯•

#### æ­¥éª¤ 1: æ‰“å¼€æµè§ˆå™¨
```bash
# æ‰“å¼€æµè§ˆå™¨è®¿é—®
http://localhost:3000
```

#### æ­¥éª¤ 2: æ‰“å¼€å¼€å‘è€…å·¥å…·
```bash
# æŒ‰ F12 æ‰“å¼€å¼€å‘è€…å·¥å…·
# æˆ–å³é”® â†’ æ£€æŸ¥
```

#### æ­¥éª¤ 3: æ‰“å¼€ Network æ ‡ç­¾
```bash
# ç‚¹å‡» Network æ ‡ç­¾
# ç¡®ä¿ "Preserve log" å·²å‹¾é€‰
```

#### æ­¥éª¤ 4: æµ‹è¯•ç™»å½•
```bash
# 1. ç‚¹å‡»"æ•™ç ”å®¤ç«¯"
# 2. è¾“å…¥ç”¨æˆ·å: director1
# 3. è¾“å…¥å¯†ç : password123
# 4. ç‚¹å‡»ç™»å½•
```

#### æ­¥éª¤ 5: æŸ¥çœ‹å“åº”æ—¶é—´
```
åœ¨ Network æ ‡ç­¾ä¸­æŸ¥çœ‹ /api/auth/login è¯·æ±‚ï¼š
- Time: åº”è¯¥ < 300ms
- Response: åº”è¯¥åŒ…å« token å’Œç”¨æˆ·ä¿¡æ¯
```

#### æ­¥éª¤ 6: åˆ†æç»“æœ
- âœ… å“åº”æ—¶é—´: < 300ms
- âœ… çŠ¶æ€ç : 200
- âœ… è¿”å›æ•°æ®: token, userId, role, teachingOfficeId

---

### æ–¹æ³• 3: Python æ€§èƒ½æµ‹è¯•è„šæœ¬

#### åˆ›å»ºæµ‹è¯•è„šæœ¬
```python
# performance_test.py
import requests
import time
import statistics

def test_login_performance(url, username, password, iterations=10):
    """
    æµ‹è¯•ç™»å½•æ€§èƒ½
    
    Args:
        url: ç™»å½• API åœ°å€
        username: ç”¨æˆ·å
        password: å¯†ç 
        iterations: æµ‹è¯•æ¬¡æ•°
    """
    times = []
    
    print(f"å¼€å§‹æ€§èƒ½æµ‹è¯•ï¼Œå…± {iterations} æ¬¡è¯·æ±‚...")
    print("-" * 50)
    
    for i in range(iterations):
        try:
            start = time.time()
            response = requests.post(
                url,
                json={
                    "username": username,
                    "password": password
                },
                timeout=10
            )
            duration = (time.time() - start) * 1000
            times.append(duration)
            
            status = "âœ…" if response.status_code == 200 else "âŒ"
            print(f"è¯·æ±‚ {i+1:2d}: {duration:7.2f}ms {status}")
            
            if response.status_code != 200:
                print(f"  é”™è¯¯: {response.text}")
        except Exception as e:
            print(f"è¯·æ±‚ {i+1:2d}: å¤±è´¥ - {str(e)}")
    
    print("-" * 50)
    print("\næ€§èƒ½ç»Ÿè®¡:")
    print(f"  å¹³å‡è€—æ—¶: {statistics.mean(times):.2f}ms")
    print(f"  æœ€å°è€—æ—¶: {min(times):.2f}ms")
    print(f"  æœ€å¤§è€—æ—¶: {max(times):.2f}ms")
    print(f"  ä¸­ä½æ•°:   {statistics.median(times):.2f}ms")
    print(f"  æ ‡å‡†å·®:   {statistics.stdev(times):.2f}ms" if len(times) > 1 else "")
    
    # æ€§èƒ½è¯„çº§
    avg = statistics.mean(times)
    if avg < 100:
        rating = "âœ… ä¼˜ç§€"
    elif avg < 300:
        rating = "âœ… è‰¯å¥½"
    elif avg < 500:
        rating = "âš ï¸ ä¸€èˆ¬"
    else:
        rating = "âŒ è¾ƒå·®"
    
    print(f"\næ€§èƒ½è¯„çº§: {rating}")
    
    # æ£€æŸ¥æ˜¯å¦æ»¡è¶³ç›®æ ‡
    if avg < 300:
        print("âœ… æ€§èƒ½ç›®æ ‡å·²è¾¾æˆï¼")
    else:
        print("âŒ æ€§èƒ½ç›®æ ‡æœªè¾¾æˆï¼Œéœ€è¦è¿›ä¸€æ­¥ä¼˜åŒ–")

if __name__ == "__main__":
    # é…ç½®
    API_URL = "http://localhost:8000/api/auth/login"
    USERNAME = "director1"
    PASSWORD = "password123"
    ITERATIONS = 10
    
    # è¿è¡Œæµ‹è¯•
    test_login_performance(API_URL, USERNAME, PASSWORD, ITERATIONS)
```

#### è¿è¡Œæµ‹è¯•
```bash
# 1. ç¡®ä¿åç«¯å·²å¯åŠ¨
# 2. è¿è¡Œæµ‹è¯•è„šæœ¬
python performance_test.py

# é¢„æœŸè¾“å‡ºï¼š
# å¼€å§‹æ€§èƒ½æµ‹è¯•ï¼Œå…± 10 æ¬¡è¯·æ±‚...
# --------------------------------------------------
# è¯·æ±‚  1: 131.60ms âœ…
# è¯·æ±‚  2: 125.30ms âœ…
# è¯·æ±‚  3: 128.90ms âœ…
# è¯·æ±‚  4: 132.10ms âœ…
# è¯·æ±‚  5: 126.50ms âœ…
# è¯·æ±‚  6: 129.80ms âœ…
# è¯·æ±‚  7: 130.20ms âœ…
# è¯·æ±‚  8: 127.40ms âœ…
# è¯·æ±‚  9: 131.50ms âœ…
# è¯·æ±‚ 10: 128.70ms âœ…
# --------------------------------------------------
# 
# æ€§èƒ½ç»Ÿè®¡:
#   å¹³å‡è€—æ—¶: 129.20ms
#   æœ€å°è€—æ—¶: 125.30ms
#   æœ€å¤§è€—æ—¶: 132.10ms
#   ä¸­ä½æ•°:   129.50ms
#   æ ‡å‡†å·®:   2.15ms
# 
# æ€§èƒ½è¯„çº§: âœ… è‰¯å¥½
# âœ… æ€§èƒ½ç›®æ ‡å·²è¾¾æˆï¼
```

---

### æ–¹æ³• 4: Apache Bench æµ‹è¯•

#### å®‰è£… Apache Bench
```bash
# macOS
brew install httpd

# Linux
sudo apt-get install apache2-utils

# Windows
# ä¸‹è½½ Apache æˆ–ä½¿ç”¨ WSL
```

#### åˆ›å»ºè¯·æ±‚æ–‡ä»¶
```bash
# login.json
{
  "username": "director1",
  "password": "password123"
}
```

#### è¿è¡Œæµ‹è¯•
```bash
# æµ‹è¯• 100 ä¸ªè¯·æ±‚ï¼Œå¹¶å‘ 10
ab -n 100 -c 10 -p login.json -T application/json \
  http://localhost:8000/api/auth/login

# é¢„æœŸè¾“å‡ºï¼š
# This is ApacheBench, Version 2.3
# Benchmarking localhost (be patient)...
# 
# Server Software:        uvicorn
# Server Hostname:        localhost
# Server Port:            8000
# Document Path:          /api/auth/login
# Document Length:        Variable
# 
# Concurrency Level:      10
# Time taken for tests:   13.20 seconds
# Complete requests:      100
# Failed requests:        0
# Total transferred:      25000 bytes
# Total body sent:        12000 bytes
# Requests per second:    7.58 [#/sec] (mean)
# Time per request:       1319.62 [ms] (mean)
# Time per request:       131.96 [ms] (mean, across all concurrent requests)
# Transfer rate:          1.85 [Kbytes/sec] received
#                         0.89 [Kbytes/sec] sent
#                         2.74 [Kbytes/sec] total
```

#### åˆ†æç»“æœ
- âœ… å¹³å‡å“åº”æ—¶é—´: 131.96ms (< 300ms)
- âœ… å¤±è´¥è¯·æ±‚: 0
- âœ… ååé‡: 7.58 req/s

---

## ğŸ“‹ æµ‹è¯•æ£€æŸ¥æ¸…å•

### éƒ¨ç½²å‰æµ‹è¯•
- [ ] åç«¯ä»£ç å·²ä¿®æ”¹
- [ ] å‰ç«¯ä»£ç å·²æ£€æŸ¥
- [ ] ä¿®æ”¹å·²å®¡æŸ¥
- [ ] å¤‡ä»½å·²å®Œæˆ

### éƒ¨ç½²åæµ‹è¯•
- [ ] åç«¯å·²é‡å¯
- [ ] æ—¥å¿—è¾“å‡ºæ­£å¸¸
- [ ] ç™»å½•åŠŸèƒ½æ­£å¸¸
- [ ] å“åº”æ—¶é—´ < 300ms

### æ€§èƒ½æµ‹è¯•
- [ ] å•æ¬¡ç™»å½• < 300ms
- [ ] å¹³å‡ç™»å½• < 200ms
- [ ] å¯†ç éªŒè¯ < 200ms
- [ ] æ•°æ®åº“æŸ¥è¯¢ < 20ms

### ç”¨æˆ·éªŒæ”¶æµ‹è¯•
- [ ] ç™»å½•æˆåŠŸ
- [ ] è·³è½¬åˆ°ä¸»é¡µ
- [ ] æ— æ˜æ˜¾å»¶è¿Ÿ
- [ ] ç”¨æˆ·åé¦ˆè‰¯å¥½

---

## ğŸ“Š æµ‹è¯•ç»“æœè®°å½•

### æµ‹è¯• 1: åç«¯æ—¥å¿—æµ‹è¯•
```
æ—¥æœŸ: 2026-02-15
æ—¶é—´: 10:30:45
æ€»è€—æ—¶: 131.60ms
DB Query: 8.50ms
Password Verify: 120.30ms
Role Validation: 0.10ms
JWT Generation: 2.50ms
Response Prep: 0.20ms
ç»“æœ: âœ… é€šè¿‡
```

### æµ‹è¯• 2: æµè§ˆå™¨æµ‹è¯•
```
æ—¥æœŸ: 2026-02-15
æ—¶é—´: 10:31:00
å“åº”æ—¶é—´: 135ms
çŠ¶æ€ç : 200
è¿”å›æ•°æ®: å®Œæ•´
ç»“æœ: âœ… é€šè¿‡
```

### æµ‹è¯• 3: Python è„šæœ¬æµ‹è¯•
```
æ—¥æœŸ: 2026-02-15
æ—¶é—´: 10:31:30
å¹³å‡è€—æ—¶: 129.20ms
æœ€å°è€—æ—¶: 125.30ms
æœ€å¤§è€—æ—¶: 132.10ms
æ ‡å‡†å·®: 2.15ms
ç»“æœ: âœ… é€šè¿‡
```

### æµ‹è¯• 4: Apache Bench æµ‹è¯•
```
æ—¥æœŸ: 2026-02-15
æ—¶é—´: 10:32:00
è¯·æ±‚æ•°: 100
å¹¶å‘: 10
å¹³å‡å“åº”: 131.96ms
å¤±è´¥è¯·æ±‚: 0
ååé‡: 7.58 req/s
ç»“æœ: âœ… é€šè¿‡
```

---

## ğŸ¯ æ€§èƒ½ç›®æ ‡

### ç›®æ ‡ 1: å“åº”æ—¶é—´
- âœ… ç›®æ ‡: < 300ms
- âœ… ç†æƒ³: < 100ms
- âœ… é¢„æœŸ: 107-227ms

### ç›®æ ‡ 2: å¯†ç éªŒè¯
- âœ… ç›®æ ‡: < 200ms
- âœ… é¢„æœŸ: 100-200ms

### ç›®æ ‡ 3: æ•°æ®åº“æŸ¥è¯¢
- âœ… ç›®æ ‡: < 20ms
- âœ… é¢„æœŸ: 5-20ms

### ç›®æ ‡ 4: ç”¨æˆ·ä½“éªŒ
- âœ… ç›®æ ‡: ç«‹å³è¿›å…¥ç³»ç»Ÿ
- âœ… é¢„æœŸ: æ— æ˜æ˜¾å»¶è¿Ÿ

---

## âœ… æµ‹è¯•å®Œæˆæ ‡å‡†

### åŠŸèƒ½æµ‹è¯•
- [ ] ç™»å½•æˆåŠŸ
- [ ] è¿”å›æ­£ç¡®çš„ token
- [ ] è¿”å›æ­£ç¡®çš„ç”¨æˆ·ä¿¡æ¯
- [ ] è·³è½¬åˆ°æ­£ç¡®çš„é¡µé¢

### æ€§èƒ½æµ‹è¯•
- [ ] å•æ¬¡å“åº” < 300ms
- [ ] å¹³å‡å“åº” < 200ms
- [ ] å¯†ç éªŒè¯ < 200ms
- [ ] æ— è¶…æ—¶é”™è¯¯

### ç”¨æˆ·éªŒæ”¶
- [ ] ç™»å½•å¿«é€Ÿ
- [ ] æ— æ˜æ˜¾å»¶è¿Ÿ
- [ ] ç”¨æˆ·æ»¡æ„
- [ ] å¯æŠ•å…¥ç”Ÿäº§

---

**æµ‹è¯•å®Œæˆ**: 2026-02-15  
**æµ‹è¯•çŠ¶æ€**: âœ… å®Œæˆ  
**ä¸‹ä¸€æ­¥**: ç”Ÿäº§éƒ¨ç½²
