# 附件提交按钮无法点击问题修复

## 问题描述
用户上传文件成功后，"提交附件"按钮仍然是禁用状态（灰色），无法点击。

## 问题原因
上传成功后，代码尝试调用`fetchAttachmentDetails()`函数从后端获取附件详情，但这个API调用可能失败，导致`uploadedAttachments`数组为空，从而触发按钮禁用条件。

## 按钮禁用条件
```typescript
:disabled="uploadedAttachments.length === 0 || isLocked"
```

当`uploadedAttachments`数组为空时，按钮被禁用。

## 修复方案
修改`handleSuccess`函数，在上传成功后直接将附件信息添加到`uploadedAttachments`数组，而不是再次请求API。

### 修改文件
`frontend/src/components/AttachmentUpload.vue`

### 修改内容
```typescript
// 修改前：尝试从API获取附件详情
if (response.attachmentIds && response.attachmentIds.length > 0) {
  fetchAttachmentDetails(response.attachmentIds[0])
}

// 修改后：直接添加附件信息到列表
if (response.attachment_ids && response.attachment_ids.length > 0) {
  uploadedAttachments.value.push({
    id: response.attachment_ids[0],
    evaluation_id: props.evaluationId,
    indicator: uploadForm.indicator,
    fileName: file.name,
    fileSize: file.size || 0,
    fileType: file.type || 'application/octet-stream',
    storage_path: '',
    classified_by: 'user',
    uploadedAt: new Date().toISOString(),
    is_archived: true,
    archived_at: new Date().toISOString()
  } as Attachment)
}
```

## 测试步骤

1. **刷新页面**
   - 按F5刷新浏览器
   - 或清除缓存后重新访问

2. **重新上传文件**
   - 登录教研室端
   - 点击"材料提交"
   - 选择考核指标
   - 上传一个文件

3. **验证按钮状态**
   - 文件上传成功后
   - "提交附件"按钮应该变为可点击状态（蓝色）
   - 点击按钮应该能成功提交

## 预期结果
- ✅ 文件上传成功后，立即显示在"已上传附件"列表中
- ✅ "提交附件"按钮变为可点击状态
- ✅ 点击按钮可以成功提交附件

## 注意事项
- 修改后需要刷新浏览器才能生效
- 如果使用了构建工具（如Vite），可能需要重启开发服务器
- 确保前端开发服务器正在运行

## 相关文件
- `frontend/src/components/AttachmentUpload.vue` - 附件上传组件
- `backend/app/schemas/attachment.py` - 附件响应Schema
- `backend/app/api/v1/endpoints/attachments.py` - 附件上传API
