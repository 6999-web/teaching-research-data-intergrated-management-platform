# 教研室端界面更新说明

## 更新时间
2026-02-14

## 更新内容

### 1. 菜单项修改
将"材料提交"改为"结果查看"

#### 修改前
- 填写自评表
- 材料提交 ❌
- 下学期改进措施

#### 修改后
- 填写自评表
- 结果查看 ✅
- 下学期改进措施

### 2. 功能调整

#### 结果查看页面
新增了评分结果查看功能，包括：
- 评分汇总卡片
  - 常规教学工作总分
  - 特色与亮点项目总分
  - 负面清单扣分
  - 最终得分
- 评分详情卡片
  - 显示详细的评分反馈

#### 附件上传集成
- 附件上传功能已集成到"填写自评表"页面中
- 用户可以在填写表单的同时上传附件
- 提交表单时自动上传附件

### 3. 提交流程优化

#### 新的提交流程
1. 用户填写自评表
2. 可选：上传附件
3. 点击"提交表单并上传附件"按钮
4. 系统执行：
   - 保存自评表数据
   - 上传附件（如果有）
   - 提交到考评小组
   - 自动触发AI评分
5. 显示成功提示

#### 错误处理改进
- 401错误：提示登录并跳转到登录页
- 403错误：提示权限不足
- 其他错误：显示详细错误信息

### 4. 界面美化

#### 结果查看页面样式
- 使用卡片布局
- 彩色分数显示
  - 常规分数：蓝色
  - 负面扣分：红色
  - 最终得分：绿色
- 清晰的标题和标签
- 响应式设计

## 功能说明

### 填写自评表
1. 填写8个必填项（常规教学工作）
2. 可选：添加特色与亮点项目
3. 可选：填写负面清单
4. 可选：上传附件
5. 点击提交

### 结果查看
1. 查看评分汇总
2. 查看评分详情
3. 查看反馈信息

### 下学期改进措施
1. 查看所有老师的改进措施
2. 按教师、指标、状态筛选
3. 查看详细的改进计划

## 技术实现

### 组件结构
```
TeachingOfficeHome.vue
├── NewSelfEvaluationForm.vue (填写自评表)
├── 结果查看 (新增)
└── 改进措施列表
```

### 数据流
```
用户填写表单
  ↓
提交表单数据
  ↓
上传附件（如果有）
  ↓
提交到考评小组
  ↓
触发AI评分
  ↓
显示成功提示
```

### API调用
```typescript
// 1. 保存自评表
await selfEvaluationApi.save({
  teaching_office_id: string,
  evaluation_year: number,
  content: object
})

// 2. 上传附件
await uploadAttachments(evaluationId)

// 3. 提交并锁定
await selfEvaluationApi.submit(evaluationId)

// 4. 触发AI评分
await selfEvaluationApi.triggerAIScoring(evaluationId)
```

## 使用指南

### 访问方式
1. 登录系统：http://localhost:3000
2. 使用教研室账号登录（如 office1 / password123）
3. 进入教研室端主页

### 填写自评表
1. 点击左侧菜单"填写自评表"
2. 填写所有必填项
3. 可选：上传附件
4. 点击"提交表单并上传附件"

### 查看结果
1. 点击左侧菜单"结果查看"
2. 查看评分汇总
3. 查看评分详情

### 查看改进措施
1. 点击左侧菜单"下学期改进措施"
2. 查看所有老师的改进计划
3. 按需筛选和查看

## 注意事项

### 对用户
1. 附件上传是可选的
2. 提交后无法修改，需要管理员打回
3. 结果查看页面目前显示示例数据
4. 实际评分结果需要等待考评小组评分

### 对开发者
1. 结果查看页面需要连接实际API
2. 需要实现评分数据的获取和显示
3. 需要添加评分详情的展示逻辑
4. 建议添加数据刷新功能

## 后续优化建议

### 短期优化
1. 连接实际评分API
2. 实现评分数据的实时更新
3. 添加评分历史记录
4. 支持评分结果导出

### 长期优化
1. 添加评分趋势图表
2. 实现评分对比分析
3. 添加评分预警功能
4. 支持评分数据统计

## 测试建议

### 测试场景
1. ✅ 填写并提交自评表（不上传附件）
2. ✅ 填写并提交自评表（上传附件）
3. ✅ 查看结果页面
4. ✅ 查看改进措施
5. ✅ 测试错误处理（401、403等）

### 测试账号
```
用户名: office1
密码: password123
角色: 教研室端
```

## 相关文件
- `frontend/src/views/TeachingOfficeHome.vue` - 主页面
- `frontend/src/components/NewSelfEvaluationForm.vue` - 自评表表单
- `frontend/src/api/client.ts` - API客户端

## 总结
本次更新将"材料提交"改为"结果查看"，并优化了提交流程和错误处理。附件上传功能已集成到自评表表单中，用户体验更加流畅。
