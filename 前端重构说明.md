# 前端重构说明 - 统一登录界面

## 📋 重构概述

本次重构将系统优化为**统一登录入口**架构，提供更清晰的用户体验和更合理的权限划分。

### 重构时间
- **日期**: 2026-02-09
- **版本**: v2.0.0

---

## 🎯 新架构设计

### 系统入口流程

```
登录页面 (Login.vue)
    ↓
三个入口选择：
    ├─ 教研室端 (需要登录)
    │   ├─ 普通教师
    │   ├─ 教研室负责人
    │   └─ 二级学院负责人
    │
    ├─ 管理端 (需要登录)
    │   ├─ 学校教务处负责人
    │   └─ 校长办公会
    │
    └─ 数据大屏 (无需登录，公开展示)
```

---

## 📁 新增文件

### 1. Login.vue - 统一登录页面
**路径**: `frontend/src/views/Login.vue`

**功能**:
- 三个入口卡片展示（教研室端、管理端、数据大屏）
- 点击教研室端/管理端弹出登录对话框
- 根据选择的端口显示不同的角色选项
- 数据大屏直接跳转，无需登录

**特点**:
- 渐变背景 + 动画装饰
- 卡片悬停效果
- 响应式设计
- 美观的登录对话框

### 2. TeachingOfficeHome.vue - 教研室端主页
**路径**: `frontend/src/views/TeachingOfficeHome.vue`

**功能**:
- 根据用户角色显示不同的菜单和功能
- 普通教师：查看结果、数据分析
- 教研室负责人：自评管理、材料管理、AI评分、改进闭环
- 二级学院负责人：学院驾驶舱、整改督导
- 显示流程条（8步流程）
- 退出登录功能

**特点**:
- 警察蓝色主题
- 角色专属配色
- 流程可视化
- 功能卡片网格布局

### 3. ManagementHome.vue - 管理端主页
**路径**: `frontend/src/views/ManagementHome.vue`

**功能**:
- 监控中心：全校概览、实时数据
- 评分管理：手动评分、最终得分
- 异常处理：异常数据、处理记录
- 公示管理：发起公示、数据同步
- 校长办公会：数据看板、审批中心

**特点**:
- 粉红渐变主题
- 管理功能集中
- 数据监控导向
- 退出登录功能

### 4. DataDashboard.vue - 数据大屏
**路径**: `frontend/src/views/DataDashboard.vue`

**功能**:
- 关键指标展示（参评教研室、完成情况、平均得分）
- 教研室排名 TOP 10
- 评分分布图表
- 月度趋势分析
- 各学院对比
- 综合指标雷达图
- 实时时间显示
- 登录系统按钮

**特点**:
- 深色科技风格
- 大屏展示设计
- 实时数据更新
- 无需登录访问
- 炫酷的视觉效果

---

## 🔄 修改文件

### 1. router/index.ts - 路由配置
**修改内容**:
- 根路径 `/` 重定向到 `/login`
- 新增 `/login` 路由
- 新增 `/teaching-office-home` 路由（教研室端）
- 新增 `/management-home` 路由（管理端）
- 新增 `/data-dashboard` 路由（数据大屏）
- 保留原有的 `/home` 路由（兼容旧版）
- 添加 `requiresAuth` 元数据标记需要登录的页面

### 2. stores/auth.ts - 认证状态管理
**修改内容**:
- 新增 `president_office` 角色（校长办公会）
- 更新角色名称映射
- 更新角色颜色映射
- 修改 `logout` 方法，清除更多本地存储
- 修改 `loadFromStorage` 方法，加载用户名

---

## 🎨 设计特点

### 登录页面
- **背景**: 紫色渐变 + 动画圆圈装饰
- **卡片**: 白色卡片 + 悬停动画
- **图标**: 渐变色图标
- **标签**: 功能标签展示
- **响应式**: 移动端单列布局

### 教研室端
- **主题色**: 警察蓝 (#1e3a5f)
- **侧边栏**: 深蓝色固定侧边栏
- **角色配色**:
  - 普通教师: 天蓝色 (#42a5f5)
  - 教研室负责人: 深绿色 (#66bb6a)
  - 二级学院负责人: 紫色 (#ab47bc)
- **流程条**: 8步流程可视化

### 管理端
- **主题色**: 粉红渐变 (#f093fb → #f5576c)
- **侧边栏**: 粉红渐变固定侧边栏
- **功能分类**: 5大模块
  - 监控中心
  - 评分管理
  - 异常处理
  - 公示管理
  - 校长办公会

### 数据大屏
- **主题色**: 深色科技风 (#0a0e27)
- **背景**: 深蓝黑色渐变
- **卡片**: 半透明卡片 + 边框光效
- **排名**: 前三名金银铜牌效果
- **图表**: 占位符设计（待集成图表库）

---

## 🚀 使用指南

### 1. 启动系统

```bash
# 启动前端
cd frontend
npm run dev
```

访问: http://localhost:3000

### 2. 登录流程

#### 教研室端登录
1. 点击"教研室端"卡片
2. 输入用户名和密码
3. 选择角色（普通教师/教研室负责人/二级学院负责人）
4. 点击"登录"
5. 跳转到教研室端主页

#### 管理端登录
1. 点击"管理端"卡片
2. 输入用户名和密码
3. 选择角色（学校教务处负责人/校长办公会）
4. 点击"登录"
5. 跳转到管理端主页

#### 数据大屏访问
1. 点击"数据大屏"卡片
2. 直接跳转，无需登录
3. 查看实时数据

### 3. 测试账号（模拟）

当前为模拟登录，任意用户名密码（6位以上）+ 角色选择即可登录。

---

## 📊 功能对比

### 旧版本 (v1.1.0)
- ❌ 直接进入主页，无登录界面
- ❌ 双模式切换（三端模式/四角色模式）
- ❌ 模式切换按钮在侧边栏
- ❌ 所有功能混在一起

### 新版本 (v2.0.0)
- ✅ 统一登录入口
- ✅ 三个独立端口（教研室端/管理端/数据大屏）
- ✅ 角色在登录时选择
- ✅ 功能按端口清晰划分
- ✅ 数据大屏无需登录
- ✅ 更美观的UI设计
- ✅ 更清晰的用户流程

---

## 🔧 技术实现

### 路由守卫（待实现）

```typescript
router.beforeEach((to, from, next) => {
  const authStore = useAuthStore()
  
  if (to.meta.requiresAuth && !authStore.isLoggedIn) {
    next('/login')
  } else {
    next()
  }
})
```

### 登录API集成（待实现）

```typescript
// 在 Login.vue 中
const handleLogin = async () => {
  try {
    const response = await apiClient.post('/auth/login', {
      username: loginForm.value.username,
      password: loginForm.value.password,
      role: loginForm.value.role
    })
    
    authStore.token = response.data.token
    authStore.userName = response.data.username
    authStore.userRole = response.data.role
    
    // 跳转到对应端口
    if (selectedPortal.value === 'teaching-office') {
      router.push('/teaching-office-home')
    } else {
      router.push('/management-home')
    }
  } catch (error) {
    ElMessage.error('登录失败')
  }
}
```

---

## 📝 待完成事项

### 高优先级
- [ ] 集成真实的登录API
- [ ] 实现路由守卫（权限验证）
- [ ] 数据大屏集成图表库（ECharts/Chart.js）
- [ ] 实现数据大屏的实时数据更新

### 中优先级
- [ ] 添加"记住我"功能
- [ ] 添加"忘记密码"功能
- [ ] 优化移动端体验
- [ ] 添加加载动画

### 低优先级
- [ ] 添加主题切换（深色/浅色）
- [ ] 添加多语言支持
- [ ] 添加用户头像上传
- [ ] 添加系统公告

---

## 🐛 已知问题

1. **登录验证**: 当前为模拟登录，未连接后端API
2. **图表展示**: 数据大屏的图表为占位符，需要集成图表库
3. **数据刷新**: 数据大屏的数据为静态数据，需要实现实时更新
4. **路由守卫**: 未实现路由守卫，可以直接访问任何页面

---

## 📚 相关文档

- [教研室数据管理平台介绍文档](教研室数据管理平台介绍文档.md)
- [双模式功能实施完成说明](双模式功能实施完成说明.md)
- [前端美化说明](前端美化说明.md)
- [四角色完整UI设计方案](四角色完整UI设计方案.md)

---

## 🎯 下一步计划

1. **集成后端API**: 连接真实的登录接口
2. **图表库集成**: 在数据大屏中集成ECharts
3. **权限系统**: 实现完整的权限验证
4. **数据实时更新**: WebSocket或轮询实现实时数据
5. **性能优化**: 代码分割、懒加载
6. **测试**: 单元测试、集成测试

---

## 📞 技术支持

如有问题，请查看：
- 前端代码: `frontend/src/views/`
- 路由配置: `frontend/src/router/index.ts`
- 状态管理: `frontend/src/stores/auth.ts`

---

**最后更新**: 2026-02-09  
**版本**: v2.0.0  
**状态**: ✅ 重构完成，待集成后端

---

© 2026 教研室数据管理平台. All rights reserved.
