# å¿«é€Ÿè§£å†³æ–¹æ¡ˆ

## é—®é¢˜
æ— æ³•æäº¤è¡¨å•åˆ°è€ƒè¯„å°ç»„ç«¯çš„æ‰‹åŠ¨è¯„åˆ†é¡µé¢ã€‚

## æ ¹æœ¬åŸå› 
**ç”¨æˆ·æ²¡æœ‰ç™»å½•ï¼** åç«¯APIéœ€è¦JWT tokenè®¤è¯ã€‚

## è§£å†³æ–¹æ¡ˆ

### æ–¹æ³•1: ä½¿ç”¨ç°æœ‰è´¦å·ç™»å½•ï¼ˆæœ€ç®€å•ï¼‰

å¦‚æœç³»ç»Ÿä¸­å·²ç»æœ‰ç”¨æˆ·è´¦å·ï¼š

1. **è®¿é—®ç™»å½•é¡µé¢**
   ```
   http://localhost:3000/login
   ```

2. **è¾“å…¥ç”¨æˆ·åå’Œå¯†ç ç™»å½•**

3. **ç™»å½•æˆåŠŸåè®¿é—®è‡ªè¯„è¡¨é¡µé¢**
   ```
   http://localhost:3000/self-evaluation
   ```

4. **å¡«å†™å¹¶æäº¤è¡¨å•**

### æ–¹æ³•2: ç›´æ¥åœ¨æ•°æ®åº“ä¸­åˆ›å»ºç”¨æˆ·

å¦‚æœæ²¡æœ‰è´¦å·ï¼Œå¯ä»¥ç›´æ¥åœ¨MySQLæ•°æ®åº“ä¸­åˆ›å»ºï¼š

```sql
-- è¿æ¥åˆ°MySQL
mysql -u root -proot

-- ä½¿ç”¨æ•°æ®åº“
USE teaching_office_evaluation;

-- åˆ›å»ºæ•™ç ”å®¤
INSERT INTO teaching_offices (id, name, description, created_at, updated_at)
VALUES ('test-office-001', 'æµ‹è¯•æ•™ç ”å®¤', 'ç”¨äºæµ‹è¯•', NOW(), NOW())
ON DUPLICATE KEY UPDATE name=name;

-- åˆ›å»ºæ•™ç ”å®¤ç«¯ç”¨æˆ·
-- å¯†ç : password123 (å·²åŠ å¯†)
INSERT INTO users (id, username, name, email, hashed_password, role, teaching_office_id, created_at, updated_at)
VALUES (
    UUID(),
    'test_teaching_office',
    'æµ‹è¯•æ•™ç ”å®¤ç”¨æˆ·',
    'teaching@test.com',
    '$2b$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewY5GyYzpLaEg7Iq',
    'teaching_office',
    'test-office-001',
    NOW(),
    NOW()
)
ON DUPLICATE KEY UPDATE username=username;

-- åˆ›å»ºè€ƒè¯„å°ç»„ç”¨æˆ·
INSERT INTO users (id, username, name, email, hashed_password, role, created_at, updated_at)
VALUES (
    UUID(),
    'test_eval_team',
    'æµ‹è¯•è€ƒè¯„å°ç»„ç”¨æˆ·',
    'evalteam@test.com',
    '$2b$12$LQv3c1yqBWVHxkd0LHAkCOYz6TtxMQJqhN8/LewY5GyYzpLaEg7Iq',
    'evaluation_team',
    NOW(),
    NOW()
)
ON DUPLICATE KEY UPDATE username=username;
```

### æ–¹æ³•3: ä½¿ç”¨APIç›´æ¥åˆ›å»ºç”¨æˆ·

å¦‚æœæœ‰ç®¡ç†å‘˜æƒé™ï¼Œå¯ä»¥é€šè¿‡APIåˆ›å»ºç”¨æˆ·ã€‚

## æµ‹è¯•æ­¥éª¤

### 1. ç™»å½•
```
è®¿é—®: http://localhost:3000/login
ç”¨æˆ·å: test_teaching_office
å¯†ç : password123
```

### 2. æäº¤è‡ªè¯„è¡¨
```
è®¿é—®: http://localhost:3000/self-evaluation
å¡«å†™è¡¨å•
ç‚¹å‡»"æäº¤è¡¨å•"
```

### 3. æŸ¥çœ‹ç»“æœ
```
é€€å‡ºç™»å½•
ä½¿ç”¨è€ƒè¯„å°ç»„è´¦å·ç™»å½•:
  ç”¨æˆ·å: test_eval_team
  å¯†ç : password123

è®¿é—®: http://localhost:3000/manual-scoring
åº”è¯¥èƒ½çœ‹åˆ°åˆšæäº¤çš„è‡ªè¯„è¡¨
```

## å·²ä¿®å¤çš„é—®é¢˜

### 1. ç§»é™¤é™„ä»¶å¼ºåˆ¶è¦æ±‚
- âœ… ç°åœ¨å¯ä»¥ä¸ä¸Šä¼ é™„ä»¶ç›´æ¥æäº¤
- âœ… AIè¯„åˆ†ä¹Ÿä¸å†å¼ºåˆ¶è¦æ±‚é™„ä»¶

### 2. åç«¯ä»£ç å·²æ›´æ–°
- âœ… `backend/app/api/v1/endpoints/self_evaluation.py`

## éªŒè¯æ–¹æ³•

### æ£€æŸ¥æ˜¯å¦ç™»å½•
æ‰“å¼€æµè§ˆå™¨æ§åˆ¶å°ï¼ˆF12ï¼‰ï¼ŒæŸ¥çœ‹ï¼š
```javascript
localStorage.getItem('token')
```

å¦‚æœè¿”å› `null`ï¼Œè¯´æ˜æ²¡æœ‰ç™»å½•ã€‚

### æ£€æŸ¥åç«¯æ—¥å¿—
æŸ¥çœ‹åç«¯è¿›ç¨‹è¾“å‡ºï¼Œåº”è¯¥çœ‹åˆ°ï¼š
```
INFO: POST /api/auth/login - 200 OK
INFO: POST /api/teaching-office/self-evaluation - 201 Created
INFO: POST /api/teaching-office/self-evaluation/{id}/submit - 200 OK
```

å¦‚æœçœ‹åˆ° `401 Unauthorized`ï¼Œè¯´æ˜æ²¡æœ‰ç™»å½•æˆ–tokenæ— æ•ˆã€‚

## å¸¸è§é”™è¯¯

### é”™è¯¯1: "Could not validate credentials"
**åŸå› **: æ²¡æœ‰ç™»å½•

**è§£å†³**: è®¿é—®ç™»å½•é¡µé¢å¹¶ç™»å½•

### é”™è¯¯2: "è¯·å…ˆä¸Šä¼ é™„ä»¶åå†æäº¤"
**åŸå› **: åç«¯ä»£ç æœªæ›´æ–°

**è§£å†³**: 
1. ç¡®ä¿åç«¯ä»£ç å·²æ›´æ–°
2. é‡å¯åç«¯æœåŠ¡

### é”™è¯¯3: æäº¤ååœ¨æ‰‹åŠ¨è¯„åˆ†é¡µé¢çœ‹ä¸åˆ°
**åŸå› **: 
- ä½¿ç”¨çš„è´¦å·è§’è‰²ä¸å¯¹
- çŠ¶æ€ä¸æ˜¯ `locked` æˆ– `ai_scored`

**è§£å†³**:
- ä½¿ç”¨è€ƒè¯„å°ç»„æˆ–è€ƒè¯„åŠå…¬å®¤è´¦å·ç™»å½•
- æ£€æŸ¥è‡ªè¯„è¡¨çŠ¶æ€

## å¿«é€Ÿæµ‹è¯•å‘½ä»¤

### æµ‹è¯•ç™»å½•API
```bash
curl -X POST http://localhost:8000/api/auth/login \
  -H "Content-Type: application/x-www-form-urlencoded" \
  -d "username=test_teaching_office&password=password123"
```

### æµ‹è¯•åˆ›å»ºè‡ªè¯„è¡¨API
```bash
# å…ˆè·å–token
TOKEN="your_token_here"

curl -X POST http://localhost:8000/api/teaching-office/self-evaluation \
  -H "Authorization: Bearer $TOKEN" \
  -H "Content-Type: application/json" \
  -d '{
    "teaching_office_id": "test-office-001",
    "evaluation_year": 2024,
    "content": {}
  }'
```

## æ€»ç»“

### é—®é¢˜æ ¹æº
âŒ ç”¨æˆ·æ²¡æœ‰ç™»å½•

### è§£å†³æ–¹æ¡ˆ
âœ… ç™»å½•ç³»ç»Ÿè·å–token

### éªŒè¯æ–¹æ³•
âœ… æ£€æŸ¥localStorageä¸­çš„token
âœ… æŸ¥çœ‹åç«¯æ—¥å¿—
âœ… æµ‹è¯•å®Œæ•´æµç¨‹

## ç«‹å³è¡ŒåŠ¨

1. **è®¿é—®ç™»å½•é¡µé¢**: http://localhost:3000/login
2. **ä½¿ç”¨æµ‹è¯•è´¦å·ç™»å½•**: test_teaching_office / password123
3. **æäº¤è‡ªè¯„è¡¨**: http://localhost:3000/self-evaluation
4. **éªŒè¯ç»“æœ**: http://localhost:3000/manual-scoring

å°±è¿™ä¹ˆç®€å•ï¼ğŸ‰
