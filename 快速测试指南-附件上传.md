# 快速测试指南 - 表单提交和附件上传

## 服务状态 ✅
- **前端**: http://localhost:3000 (运行中)
- **后端**: http://localhost:8000 (运行中)

## 测试账号
```
用户名: office1
密码: password123
角色: 教研室端
```

## 测试步骤

### 1. 登录系统
1. 打开浏览器访问: http://localhost:3000
2. 输入账号: `office1`
3. 输入密码: `password123`
4. 点击"登录"

### 2. 进入自评表填写页面
1. 登录成功后，点击"自评表填写"
2. 或直接访问: http://localhost:3000/self-evaluation

### 3. 填写自评表
填写以下必填项（每项至少10个字符）：

#### 一、常规教学工作（每项10分，共80分）
1. **教学过程管理** - 填写教学计划、集体备课等内容
2. **教学质量管理** - 填写听课评议、教学检查等内容
3. **课程考核** - 填写试题规范、考核方式等内容
4. **教育教学科研工作** - 填写教改项目、学科竞赛等内容
5. **课程建设** - 填写课程大纲、教案课件等内容
6. **教师队伍建设** - 填写教师培养、进修深造等内容
7. **科学研究与学术交流** - 填写科研项目、学术活动等内容
8. **教学档案室管理与建设** - 填写档案管理等内容

每项都需要：
- 填写内容描述（10-1000字）
- 输入自评分（0-10分）

#### 二、特色与亮点项目（可选）
可以添加以下项目（也可以不添加）：
- 教学改革项目
- 荣誉表彰
- 教学比赛
- 创新创业比赛

#### 三、负面清单（默认为0）
如果没有负面情况，保持默认值即可。

### 4. 上传附件（可选但建议测试）

#### 步骤A: 选择考核指标
1. 滚动到"附件上传（可选）"区域
2. 点击"选择考核指标"下拉框
3. 选择一个指标，例如"教学改革项目"

#### 步骤B: 上传文件
1. 准备测试文件（支持格式：pdf, doc, docx, jpg, jpeg, png）
2. 可以通过两种方式上传：
   - **拖拽**: 直接拖拽文件到上传区域
   - **点击**: 点击上传区域，选择文件

#### 步骤C: 验证文件
系统会自动验证：
- ✅ 文件大小不超过50MB
- ✅ 文件格式符合要求
- ✅ 文件数量不超过10个

#### 步骤D: 添加更多文件（可选）
1. 可以继续添加更多文件到同一指标
2. 或者切换到其他考核指标，上传不同类型的文件

### 5. 提交表单
1. 检查所有必填项是否已填写
2. 查看"评分汇总"区域，确认分数计算正确
3. 点击底部的"提交表单并上传附件"按钮（如果没有附件，按钮显示"提交表单"）
4. 等待提交完成

### 6. 观察提交过程
系统会依次执行：
1. ⏳ "正在提交自评表，请稍候..."
2. ⏳ "正在上传附件，请稍候..."（如果有附件）
3. ⏳ "正在提交到考评小组，请稍候..."
4. ✅ "提交成功！数据已上传到考评小组端"
5. 🔄 自动跳转到教研室主页

## 预期结果

### 成功提交后
- ✅ 看到绿色成功提示
- ✅ 1.5秒后自动跳转到主页
- ✅ 表单数据已保存到数据库
- ✅ 附件已上传到服务器
- ✅ 状态变为"已提交"并锁定
- ✅ AI评分已自动触发

### 如果遇到错误
根据错误提示进行处理：
- "请填写所有必填项" - 检查是否有未填写的内容
- "请先选择考核指标" - 在上传文件前先选择指标
- "文件大小超过50MB限制" - 选择更小的文件
- "文件格式不支持" - 选择支持的文件格式
- "附件上传失败" - 表单已保存，可稍后单独上传附件

## 测试要点

### ✅ 必须测试
1. 填写所有必填项并提交（不上传附件）
2. 填写表单并上传1个附件
3. 填写表单并上传多个附件（不同指标）

### ✅ 建议测试
1. 尝试上传超大文件（应该被拒绝）
2. 尝试上传不支持的格式（应该被拒绝）
3. 切换考核指标（文件应该保留）
4. 删除已选择的文件

### ✅ 边界测试
1. 只填写必填项，不填写特色项目
2. 填写负面清单项目
3. 上传10个文件（达到上限）
4. 尝试上传第11个文件（应该被拒绝）

## 常见问题

### Q1: 提交按钮是灰色的？
A: 检查是否已填写所有必填项（8个常规教学工作项目）

### Q2: 无法上传文件？
A: 确保已选择考核指标，然后再上传文件

### Q3: 文件上传失败？
A: 检查文件大小和格式，确保符合要求

### Q4: 提交后想修改？
A: 提交后会自动锁定，需要联系管理员打回才能修改

### Q5: 附件是必须的吗？
A: 不是必须的，可以只提交表单不上传附件

## 调试信息

### 查看浏览器控制台
按 F12 打开开发者工具，查看：
- Network 标签：查看API请求和响应
- Console 标签：查看错误日志

### 查看后端日志
在后端目录查看 `error.log` 文件

### 数据库验证
可以使用以下SQL查询验证数据：
```sql
-- 查看自评表
SELECT * FROM self_evaluations ORDER BY created_at DESC LIMIT 1;

-- 查看附件
SELECT * FROM attachments ORDER BY uploaded_at DESC LIMIT 10;
```

## 成功标志
- ✅ 表单提交成功
- ✅ 附件上传成功（如果有）
- ✅ 自动跳转到主页
- ✅ 数据保存到数据库
- ✅ 状态变为"已提交"

## 下一步
测试成功后，可以：
1. 测试考评小组端查看提交的数据
2. 测试手动评分功能
3. 测试最终评分功能
4. 测试改进闭环功能
